<!DOCTYPE html><html><head><title>Modal Keys Documentation</title><meta charset="utf-8"><link rel="stylesheet" href="https://haberdashpi.github.io/vscode-modal-keys/dev/README.f14bba23.css"></head><body> <script type="module" src="https://haberdashpi.github.io/vscode-modal-keys/dev/README.ab2e5f5c.js"></script><script src="https://haberdashpi.github.io/vscode-modal-keys/dev/README.16885970.js" nomodule="" defer></script> <div class="content"> <h1 id="heading-#keybinding-forms"><a class="header-anchor" id="keybinding-forms" href="#keybinding-forms"> </a>Keybinding forms</h1> <p>You can define the bindings in four different ways. It is also possible to combine them freely.</p> <h2 id="heading-#single-command"><a class="header-anchor" id="single-command" href="#single-command"> </a>Single Command</h2> <p>The simplest way is to map a key to a single command. This has the format:</p> <pre><code class="language-js"><span class="hljs-attr">&quot;&lt;binding&gt;&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&lt;command&gt;&quot;</span>
</code></pre> <p>The <code>&lt;binding&gt;</code> specifies the sequence of keys to press (and possibly the mode), and <code>&lt;command&gt;</code> is any valid VS Code command. You can see the list of all available commands by opening global settings with command <strong>Preferences: Open Default Keyboard Shortcuts (JSON)</strong>.</p> <p>The example in the previous section maps the <code>i</code> key to the <code>modalkeys.enterInsert</code> command.</p> <h2 id="heading-#commands-with-arguments"><a class="header-anchor" id="commands-with-arguments" href="#commands-with-arguments"> </a>Commands with Arguments</h2> <p>Some <a href="https://code.visualstudio.com/api/references/commands#commands">commands</a> take arguments. For example <code>cursorMove</code> which allows you to specify which direction and how much cursor moves. These commands can be executed by defining an object with predefined properties:</p> <pre><code class="language-js"><span class="hljs-string">&quot;&lt;binding&gt;&quot;</span>:  {
    <span class="hljs-string">&quot;&lt;command&gt;&quot;</span>: { ... }
    <span class="hljs-string">&quot;repeat&quot;</span>: number <span class="hljs-string">| &quot;</span>&lt;expression&gt;<span class="hljs-string">&quot;</span>
}
</code></pre> <p>The <code>&lt;command&gt;</code> is again a valid VS Code command. Any arguments you wish to pass to this command should be placed inside the curly brackets. ModalKeys evaluates any argument strings that contain <code>__</code> as JavaScript expressions, and replaces the argument value with the result of this evaluation. The following variables are recognized during this evaluation.</p> <table> <thead> <tr><th>Variable</th><th>Type</th><th>Description</th></tr> </thead> <tbody> <tr><td><code>__file</code></td><td><code>string</code></td><td>The name of the current file</td></tr> <tr><td><code>__line</code></td><td><code>number</code></td><td>The line number of cursor location</td></tr> <tr><td><code>__col</code></td><td><code>number</code></td><td>The column number of cursor location</td></tr> <tr><td><code>__char</code></td><td><code>string</code></td><td>The character under the cursor</td></tr> <tr><td><code>__language</code></td><td><code>string</code></td><td>The languageId of the current file</td></tr> <tr><td><code>__selections</code></td><td><a href="https://code.visualstudio.com/api/references/vscode-api#Selection"><code>Selection[]</code></a></td><td>The selection objects of the current editor</td></tr> <tr><td><code>__selection</code></td><td><a href="https://code.visualstudio.com/api/references/vscode-api#Selection"><code>Selection</code></a></td><td>The primary selection object of the current editor</td></tr> <tr><td><code>__selectionstr</code></td><td><code>string</code></td><td>The text of the primary selection</td></tr> <tr><td><code>__wordstr</code> .</td><td><code>string</code></td><td>Same as <code>__selectionstr</code> unless there is no selection, and then this is equal to the current word under the cursor.</td></tr> <tr><td><code>__selecting</code></td><td><code>bool</code></td><td>True if text should be selected (e.g. we're in visual mode).</td></tr> <tr><td><code>__mode</code></td><td><code>string</code></td><td>A string specifying the current mode</td></tr> <tr><td><code>__count</code></td><td><code>number</code></td><td>A number indicating the prefixed numerical values in front of a command: see below.</td></tr> <tr><td><code>__captured</code></td><td><code>string</code></td><td>The list of captured keys following <a href="https://haberdashpi.github.io/vscode-modal-keys/dev/commands.html#capturing-keys"><code>captureChar</code></a></td></tr> </tbody> </table> <p>Below is an example that leverages string evaluation. It maps the key <key>o</key> to a command that moves the cursor to the end of the line. It also selects the jumped range, if we have a selection already active.</p> <pre><code class="language-js"><span class="hljs-string">&quot;o&quot;</span>: { <span class="hljs-string">&quot;cursorMove&quot;</span>: { <span class="hljs-keyword">to</span>: <span class="hljs-string">&#x27;wrappedLineEnd&#x27;</span>, <span class="hljs-keyword">select</span>: <span class="hljs-string">&#x27;__selecting&#x27;</span> } },
</code></pre> <h2 id="heading-#numeric-arguments"><a class="header-anchor" id="numeric-arguments" href="#numeric-arguments"> </a>Numeric arguments</h2> <p>When you type a modal command you can prefix it with numbers: these are passed using the <code>__count</code> variable to your command.</p> <p>For example, the following would bind h to move left (like vim) in all modes.</p> <pre><code class="language-js">    <span class="hljs-string">&quot;h&quot;</span>: { <span class="hljs-string">&quot;cursorMove&quot;</span>: { <span class="hljs-keyword">to</span>: <span class="hljs-string">&#x27;left&#x27;</span>, value: <span class="hljs-string">&#x27;__count&#x27;</span> } },
</code></pre> <p>Because <code>value</code> is specified as <code>__count</code>, if you typed <code>12h</code>, the cursor would move 12 characters to the left.</p> <h3 id="heading-#repeating-commands"><a class="header-anchor" id="repeating-commands" href="#repeating-commands"> </a>Repeating commands</h3> <p>The <code>repeat</code> property of a command allows you to run the command multiple times. If it's a number, it should indicate the number of times to repeat the command. If it's a string it is evaluated as a JavaScript expression, and should evaluate to a numeric or boolean value. If numeric, the command repeats the given number of times. If boolean, it yields while-loop behavior: the command will continue to be repeated until it evaluates to false.</p> <h3 id="heading-#shared-command-name"><a class="header-anchor" id="shared-command-name" href="#shared-command-name"> </a>Shared command name</h3> <p>You can specify a series of bindings that all use the same command, each with different arguments to that same command. Use the following format.</p> <pre><code class="language-js"><span class="hljs-string">&quot;::using::&lt;command&gt;&quot;</span>: {
    <span class="hljs-string">&quot;&lt;binding1&gt;&quot;</span>: { <span class="hljs-string">...</span> },
    <span class="hljs-string">&quot;&lt;binding2&gt;&quot;</span>: { <span class="hljs-string">...</span> },
    <span class="hljs-string">...</span>
}
</code></pre> <p>Each binding is bound to the command <code>&lt;command&gt;</code>, passing the arguments specified for that binding (<code>{...}</code>).</p> <h2 id="heading-#sequence-of-commands"><a class="header-anchor" id="sequence-of-commands" href="#sequence-of-commands"> </a>Sequence of Commands</h2> <p>To construct more complex operations consisting of multiple steps, you can define command sequences. Commands in a sequence will be run one after another. A sequence is defined as an array.</p> <pre><code class="language-js"><span class="hljs-string">&quot;&lt;binding&gt;&quot;</span>: [ &lt;<span class="hljs-keyword">command</span>1&gt;, &lt;<span class="hljs-keyword">command</span>2&gt;, <span class="hljs-string">...</span> ]
</code></pre> <p>In above, <code>&lt;command&gt;</code> can assume any of the four command types.</p> <p>The next example maps the <code>f</code> key to a command sequence that first deletes the selected text and then switch to insert mode. It corresponds to the <code>c</code> command in Vim.</p> <pre><code class="language-js"><span class="hljs-string">&quot;f&quot;</span>: [
    <span class="hljs-string">&quot;deleteRight&quot;</span>,
    <span class="hljs-string">&quot;modaledit.enterInsert&quot;</span>
],
</code></pre> <h2 id="heading-#conditional-commands"><a class="header-anchor" id="conditional-commands" href="#conditional-commands"> </a>Conditional Commands</h2> <p>For even more complex scenarios, you can define commands that run different commands depending on a specified condition. The most common use case for this is to run a different command when selection is active. The format of a conditional commands is:</p> <pre><code class="language-js"><span class="hljs-string">&quot;&lt;binding&gt;&quot;</span>:  {
    <span class="hljs-string">&quot;if&quot;</span>: <span class="hljs-string">&quot;&lt;condition&gt;&quot;</span>,
    <span class="hljs-string">&quot;then&quot;</span>: &lt;comma<span class="hljs-symbol">nd1</span>&gt;,
    <span class="hljs-string">&quot;else&quot;</span>: &lt;comma<span class="hljs-symbol">nd2</span>&gt;,
}
</code></pre> <p>Here <code>&lt;condition&gt;</code> can be any valid JavaScript expression. You can use variables listed in the &quot;Commands with Arguments&quot; section in the expression. If the expression evaluates to true, <code>&lt;command1&gt;</code> will be executed, if false, <code>&lt;command2&gt;</code> will be run. Commands can be of any kind: a single command, sequence, or command with arguments.</p> <p>Below is an example that moves cursor one word forward with <code>w</code> key. We use the <code>__mode</code> variable to determine if we're in visual mode. If so, we extend the selection using <code>cursorWordStartRightSelect</code> command, otherwise we just jump to next word with <code>cursorWordStartRight</code>.</p> <pre><code class="language-js"><span class="hljs-string">&quot;w&quot;</span>: {
    <span class="hljs-string">&quot;if&quot;</span>: <span class="hljs-string">&quot;__mode == &#x27;</span>visual&#x27;<span class="hljs-string">&quot;,
    &quot;</span><span class="hljs-keyword">then</span><span class="hljs-string">&quot;: &quot;</span>cursorWordStartRightSelect<span class="hljs-string">&quot;,
    &quot;</span><span class="hljs-keyword">else</span><span class="hljs-string">&quot;: &quot;</span>cursorWordStartRight<span class="hljs-string">&quot;
},
</span></code></pre> <h2 id="heading-#debugging-keybindings"><a class="header-anchor" id="debugging-keybindings" href="#debugging-keybindings"> </a>Debugging Keybindings</h2> <p>If you use a javascript file to define your bindings you can place <code>console.log</code> statements in the file and they will show up under the ModalKeys output log. Any errors encountered when parsing or evaluating your bindings will also show up here.</p> <p>You can find this output by opening <strong>View - Output</strong> and then choosing the <strong>ModalKeys</strong> from the drop-down menu.</p> <h2 id="heading-#documenting-a-keybinding"><a class="header-anchor" id="documenting-a-keybinding" href="#documenting-a-keybinding"> </a>Documenting a Keybinding</h2> <p>If you wish your own keybindings to leverage the visual documentation feature of ModalKeys you will also need to add a <code>::doc::</code> entries for each command. These take the following form:</p> <pre><code class="language-js"><span class="hljs-string">&quot;::doc::&lt;binding&gt;&quot;</span>: { kind: <span class="hljs-variable">&lt;kind&gt;</span>, <span class="hljs-keyword">label</span>: <span class="hljs-variable">&lt;label&gt;</span>, detail: <span class="hljs-variable">&lt;detail&gt;</span> }
</code></pre> <p>The <code>kind</code> is a string defining a broad category of keys and determines the color of the key. The label is a string that will show up on the key: it should be very short: a good guideline is ≤2 words, ≤6 chars per word. Unicode can be useful in shortening the key lable (e.g. → and ←). The detail entry is a string description that will show up when you hover the mouse over the keybinding. It should explain in much more detail what the key does. The description for the <code>kind</code> will also be included, so the detail string should not be redundant with this more general information.</p> <p>You also need to document the different command kinds used in your keymap. These are specified as an additional field of the main object of your keybindings file, called <code>docKinds</code> and takes the following format.</p> <pre><code class="language-js">module.exports = {
docKinds: [
    { name: &lt;kind1&gt;, description: &lt;str&gt; },
    <span class="hljs-regexp">//</span> etc...
],

keybindings: {
    <span class="hljs-regexp">//</span> all keybindings...
}
}
</code></pre> <p>The colors for doc kinds are determined by their order in <code>docKinds</code>, and are selected from a carefully defined <a href="https://www.fabiocrameri.ch/batlow/">Batlow</a> color scheme. There are 5 such colors, and they are chosen to be friendly to color-blind viewers by consistently varying the luminance. You can also <a href="https://haberdashpi.github.io/vscode-modal-keys/dev/config.html#color-blind-friendliness">switch</a> to a more vibrant <a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">color brewer</a> set, which has 8 distinct colors. This set is not as accessable to color-blind viewers.</p> <p>If you have more kinds than avaialble colors in your documentation, the colors will be cycled (i.e. the 6th kind will be colored the same as the 1st if you use the color-blind friendly option).</p> <h3 id="heading-#leaders"><a class="header-anchor" id="leaders" href="#leaders"> </a>Leaders</h3> <p>If your keybindings include a sequence of multiple keys (e.g. <code>gj</code>), you should also document the general role of a given sequence prefix. For example, the vim bindings include the following <code>::doc::</code> entry:</p> <pre><code class="language-js"><span class="hljs-string">&quot;::doc::g&quot;</span>: { kind: <span class="hljs-string">&quot;leader&quot;</span>, <span class="hljs-keyword">label</span><span class="language-bash">: <span class="hljs-string">&quot;more actions&quot;</span>, detail: <span class="hljs-string">&quot;additional commands (mostly actions)&quot;</span> },</span>
</code></pre> <a href="https://github.com/haberdashPI/vscode-modal-keys">View on GitHub</a> </div> </body></html>